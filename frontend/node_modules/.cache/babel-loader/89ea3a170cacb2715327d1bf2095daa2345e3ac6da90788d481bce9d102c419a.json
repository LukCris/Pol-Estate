{"ast":null,"code":"import Navbar from\"./components/navbar/Navbar\";import Footer from\"./components/footer/Footer\";import\"./layout.css\";import HomePage from\"./pages/homePage/HomePage\";import Profilo from\"./pages/profile/Profilo\";import NewPostPage from\"./pages/newPostPage/NewPostPage\";import PostDetailPage from\"./pages/postDetailPage/PostDetailPage\";import{Routes,Route}from\"react-router-dom\";import Login from\"./pages/login/Login\";import Register from\"./pages/register/Register\";import io from\"socket.io-client\";import{useState,useEffect}from\"react\";import Cookies from\"universal-cookie\";import ListPostPage from\"./pages/listPostPage/ListPostPage\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const socket=io.connect(\"http://localhost:8080\");const cookies=new Cookies();export default function App(){const[username,setUsername]=useState(\"\");const[logged,setLogged]=useState(false);function setLoggedUser(token){if(token==null){console.log(\"Cancellazione cookie\");//Comando utilizzato per rimuovere il cookie\ncookies.remove('token',{path:'/'});console.log(document.cookie);setUsername(\"\");setLogged(false);}else{//Comando utilizzato per impostare il parametro del cookie relativo al token\ncookies.set(\"token\",token,{path:'/',maxAge:1000000});console.log(\"Cookie creato: \",cookies);setLogged(true);}}useEffect(()=>{//ad ogni rendering dell'app si verificherà se il token è null per scegliere se far visualizzare le pagine di login e register oppure il resto del sito\nif(!cookies.get(\"token\")){console.log(\"nessun utente settato\");}else{console.log(\"Utente settato: \"+cookies.get(\"token\"));fetch(\"http://localhost:8080/api/auth/findUsernameByToken\",{method:\"get\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":cookies.get(\"token\")}}).then(res=>{if(res.ok)return res.json();else throw new Error(\"Errore di comunicazione\");}).then(res=>setUsername(res));}},[username]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"navbar\",children:/*#__PURE__*/_jsx(Navbar,{logged:logged})}),/*#__PURE__*/_jsxs(\"div\",{className:\"content\",children:[\" \",username===\"\"?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/homePage\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{handleUser:setLoggedUser,handleUsername:setUsername})}),/*#__PURE__*/_jsx(Route,{path:\"/registrazione\",element:/*#__PURE__*/_jsx(Register,{handleUser:setLoggedUser,handleUsername:setUsername})}),/*#__PURE__*/_jsx(Route,{path:\"nuovoPost/:username\",element:/*#__PURE__*/_jsx(Login,{handleUser:setLoggedUser,handleUsername:setUsername})}),/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(HomePage,{handleUser:setLoggedUser,handleUsername:setUsername})}),/*#__PURE__*/_jsx(Route,{path:\"/nuovoPost\",element:/*#__PURE__*/_jsx(Login,{handleUser:setLoggedUser,handleUsername:setUsername})}),/*#__PURE__*/_jsx(Route,{path:\"/listaPost\",element:/*#__PURE__*/_jsx(ListPostPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/postDetail/:id\",element:/*#__PURE__*/_jsx(PostDetailPage,{loggedUser:username})}),/*#__PURE__*/_jsx(Route,{path:\"/profilo\",element:/*#__PURE__*/_jsx(Login,{handleUser:setLoggedUser,handleUsername:username})})]})}):/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\":username\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/listaPost\",element:/*#__PURE__*/_jsx(ListPostPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/postDetail/:id\",element:/*#__PURE__*/_jsx(PostDetailPage,{loggedUser:username})}),/*#__PURE__*/_jsx(Route,{path:\"/homePage\",element:/*#__PURE__*/_jsx(HomePage,{})}),/*#__PURE__*/_jsx(Route,{path:\"nuovoPost\",element:/*#__PURE__*/_jsx(NewPostPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"profilo\",element:/*#__PURE__*/_jsx(Profilo,{handleUser:setLoggedUser,loggedUser:username,socket:socket})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer\",children:/*#__PURE__*/_jsx(Footer,{})})]});}","map":{"version":3,"names":["Navbar","Footer","HomePage","Profilo","NewPostPage","PostDetailPage","Routes","Route","Login","Register","io","useState","useEffect","Cookies","ListPostPage","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","socket","connect","cookies","App","username","setUsername","logged","setLogged","setLoggedUser","token","console","log","remove","path","document","cookie","set","maxAge","get","fetch","method","headers","then","res","ok","json","Error","className","children","element","handleUser","handleUsername","loggedUser"],"sources":["C:/Users/lpaco/WebstormProjects/progetto finale/.progetto/frontend/src/App.jsx"],"sourcesContent":["import Navbar from \"./components/navbar/Navbar\";\nimport Footer from \"./components/footer/Footer\";\nimport \"./layout.css\";\nimport HomePage from \"./pages/homePage/HomePage\";\nimport Profilo from \"./pages/profile/Profilo\";\nimport NewPostPage from \"./pages/newPostPage/NewPostPage\";\nimport PostDetailPage from \"./pages/postDetailPage/PostDetailPage\";\nimport {Routes,Route} from \"react-router-dom\";\nimport Login from \"./pages/login/Login\"\nimport Register from \"./pages/register/Register\"\nimport io from \"socket.io-client\"\nimport {useState,useEffect} from \"react\"\nimport Cookies from \"universal-cookie\"\nimport ListPostPage from \"./pages/listPostPage/ListPostPage\";\n\n\nconst socket = io.connect(\"http://localhost:8080\")\nconst cookies= new Cookies();\n\nexport default function App() {\n\n  const [username,setUsername]=useState(\"\");\n  const [logged, setLogged] = useState(false);\n\n  function setLoggedUser(token){\n    if(token==null)\n    {\n      console.log(\"Cancellazione cookie\");\n      //Comando utilizzato per rimuovere il cookie\n      cookies.remove('token', {\n        path: '/',\n      });\n      console.log(document.cookie);\n      setUsername(\"\");\n\n      setLogged(false);\n    }\n\n    else\n    {\n      //Comando utilizzato per impostare il parametro del cookie relativo al token\n      cookies.set(\"token\", token, {\n        path: '/',\n       maxAge: 1000000\n      });\n\n      console.log(\"Cookie creato: \", cookies)\n\n      setLogged(true);\n    }\n    \n  }\n\n\n\n  useEffect(()=>{\n    \n    //ad ogni rendering dell'app si verificherà se il token è null per scegliere se far visualizzare le pagine di login e register oppure il resto del sito\n    if(!cookies.get(\"token\"))\n    {\n      console.log(\"nessun utente settato\");\n    }  \n    else\n    {\n      console.log(\"Utente settato: \"+ cookies.get(\"token\"));\n      fetch(\"http://localhost:8080/api/auth/findUsernameByToken\", {\n        method: \"get\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": cookies.get(\"token\")\n        }\n      }).then(res=> {if(res.ok) return res.json(); else throw new Error(\"Errore di comunicazione\")})\n      .then(res=> setUsername(res));\n\n    }\n\n  }, [username])\n  return (\n        \n    <div className=\"container\">\n\n      <div className=\"navbar\">\n        <Navbar logged={logged}/>\n      </div>\n    \n      <div className=\"content\"> {\n\n        (username===\"\") ?\n          (<>\n          <Routes>\n            <Route path=\"/homePage\" element={<HomePage></HomePage>}></Route>\n            <Route path=\"/login\" element={<Login handleUser={setLoggedUser} handleUsername={setUsername}/>} ></Route>\n            <Route path=\"/registrazione\" element={<Register handleUser={setLoggedUser} handleUsername={setUsername}/>}/>\n            <Route path=\"nuovoPost/:username\" element={<Login handleUser={setLoggedUser} handleUsername={setUsername}/> } />\n            <Route path=\"/\" element={<HomePage handleUser={setLoggedUser} handleUsername={setUsername}/>}></Route>\n            <Route path=\"/nuovoPost\" element={<Login handleUser={setLoggedUser} handleUsername={setUsername}/>}/>\n            <Route path=\"/listaPost\" element={<ListPostPage/>}/>\n            <Route path=\"/postDetail/:id\" element={<PostDetailPage loggedUser={username}/>} />\n            <Route path=\"/profilo\" element={<Login handleUser={setLoggedUser} handleUsername={username}/>}/>\n            </Routes>\n            </>) :\n          (<Routes>\n            <Route path=\":username\" element={<HomePage/>} />\n            <Route path=\"/listaPost\" element={<ListPostPage/>}/>\n            <Route path=\"/postDetail/:id\" element={<PostDetailPage loggedUser={username}/>} />\n            <Route path=\"/homePage\" element={<HomePage/>}></Route>\n            <Route path=\"nuovoPost\" element={<NewPostPage/> } />\n            <Route path=\"profilo\" element={<Profilo handleUser={setLoggedUser} loggedUser={username} socket={socket}/> } />\n            \n          </Routes>)\n          }\n        \n        </div>\n\n        <div className=\"footer\">\n            <Footer/>\n        </div>\n    </div>\n    \n  )\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}