{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import Message from\"../message/Message\";import Button from\"react-bootstrap/Button\";import\"./messageList.css\";import{jsxs as _jsxs,jsx as _jsx,Fragment as _Fragment}from\"react/jsx-runtime\";export default function MessagesList(_ref){let{messageList,ContactName,ContactId,socket,username,handleChat,setReload}=_ref;const[body,setBody]=useState(\"\");function checkBody(){return body.length>0;}useEffect(()=>{document.getElementById(\"messagesContainer\").scrollTop=99999999;});return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chatName\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\" \",ContactName,\" \"]}),/*#__PURE__*/_jsx(Button,{className:\"deleteChatButton\",onClick:e=>{const token=document.cookie.split(\";\").find(row=>row.startsWith(\"token\")).split(\"=\")[1];console.log(\"Inizio prevent default\");e.preventDefault();fetch(\"http://localhost:8080/api/chats/deleteChat\",{method:\"post\",headers:{\"Content-Type\":\"application/json\",'Authorization':token},body:JSON.stringify({username:ContactName})}).then(res=>{if(res.ok)return res.json();else throw new Error(\"Errore di comunicazione\");}).then(res=>{window.alert(res);handleChat();setReload(true);}).catch(e=>console.log(e));},children:\"Elimina chat\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chatContainer\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"messagesContainer\",children:messageList.messages&&messageList.messages.map(e=>/*#__PURE__*/_jsx(Message,{idMessage:e,Contact:ContactId,ContactName:ContactName},e))}),/*#__PURE__*/_jsx(\"div\",{className:\"chatBar\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"chatForm\",onSubmit:e=>{e.preventDefault();setBody(\"\");//i valori del emit sarebbero il data\nsocket.emit(\"SendMessage\",{name:username,receiver:ContactId,receiverName:ContactName,body:body,id:messageList._id});e.target.insertMessage.value=\"\";},children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",name:\"insertMessage\",classname:\"bar\",onChange:e=>setBody(e.target.value)}),/*#__PURE__*/_jsx(Button,{type:\"submit\",disabled:!checkBody(),className:\"button\",children:\"Invia\"})]})})]})]});}","map":{"version":3,"names":["React","useEffect","useState","Message","Button","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","MessagesList","_ref","messageList","ContactName","ContactId","socket","username","handleChat","setReload","body","setBody","checkBody","length","document","getElementById","scrollTop","children","className","onClick","e","token","cookie","split","find","row","startsWith","console","log","preventDefault","fetch","method","headers","JSON","stringify","then","res","ok","json","Error","window","alert","catch","id","messages","map","idMessage","Contact","onSubmit","emit","name","receiver","receiverName","_id","target","insertMessage","value","type","classname","onChange","disabled"],"sources":["C:/Users/lpaco/WebstormProjects/progetto finale/.progetto/frontend/src/components/messageList/MessagesList.jsx"],"sourcesContent":["import React, {useEffect,useState} from \"react\"; \r\nimport Message from \"../message/Message\" \r\nimport Button from \"react-bootstrap/Button\" \r\nimport \"./messageList.css\"\r\n \r\nexport default function MessagesList ({messageList, ContactName, ContactId, socket, username, handleChat, setReload}){ \r\n \r\n   const [body,setBody]=useState(\"\"); \r\n    \r\n   function checkBody(){ \r\n      return body.length>0; \r\n   } \r\n\r\n   \r\n   \r\n \r\n   useEffect(()=>{ \r\n      document.getElementById(\"messagesContainer\").scrollTop=99999999; \r\n   })\r\n \r\n    return( \r\n\r\n      \r\n\r\n      <> \r\n         <div className=\"chatName\"> \r\n                  <h3> {ContactName} </h3> \r\n                  <Button className=\"deleteChatButton\" onClick={e =>{\r\n                     const token=document.cookie.split(\";\") \r\n                     .find((row) => row.startsWith(\"token\")) \r\n                     .split(\"=\")[1]; \r\n                     console.log(\"Inizio prevent default\")\r\n                     e.preventDefault()\r\n                     fetch(\"http://localhost:8080/api/chats/deleteChat\", {\r\n                        method: \"post\",\r\n                        headers: {\r\n                           \"Content-Type\": \"application/json\",\r\n                           'Authorization': token\r\n                     },\r\n                     body: JSON.stringify({\r\n                           username: ContactName\r\n                     })\r\n                     })\r\n                     .then(res=> {\r\n                        if (res.ok) return res.json(); \r\n                        else throw new Error(\"Errore di comunicazione\")})\r\n                     .then(res=>{\r\n                        window.alert(res); \r\n                        handleChat()\r\n                        setReload(true)\r\n                        \r\n                                                      \r\n                     })\r\n                     .catch(e=>console.log(e)); \r\n                  }}>Elimina chat</Button>\r\n         </div> \r\n\r\n         <div className=\"chatContainer\">\r\n            <div id=\"messagesContainer\"> \r\n               {/* Per la visualizzazione dei messaggi devo passare l'id di tutti gli elementi della lista e l'id del contatto per capire il mittente o il destinatario*/} \r\n               {messageList.messages && messageList.messages.map(e=> <Message idMessage= {e} Contact={ContactId} ContactName={ContactName} key={e}/>)} \r\n            </div> \r\n            \r\n            \r\n            <div className=\"chatBar\"> \r\n               {/*Form per l'invio del messaggio */} \r\n               <form className=\"chatForm\" onSubmit={e=> { \r\n                  e.preventDefault(); \r\n                  setBody(\"\");                //i valori del emit sarebbero il data\r\n                  socket.emit(\"SendMessage\", {name: username, receiver: ContactId, receiverName: ContactName, body: body, id: messageList._id}); \r\n                  e.target.insertMessage.value=\"\"; \r\n               }}> \r\n                  <textarea type=\"text\" name=\"insertMessage\" classname=\"bar\" onChange={e=> \r\n                     setBody(e.target.value) \r\n                  }></textarea> \r\n                  <Button type=\"submit\" disabled={!checkBody()} className=\"button\">Invia</Button> \r\n               </form> \r\n            </div> \r\n         </div>\r\n         \r\n\r\n      </> \r\n   )       \r\n}"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAGC,SAAS,CAACC,QAAQ,KAAO,OAAO,CAC/C,MAAO,CAAAC,OAAO,KAAM,oBAAoB,CACxC,MAAO,CAAAC,MAAM,KAAM,wBAAwB,CAC3C,MAAO,mBAAmB,QAAAC,IAAA,IAAAC,KAAA,CAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE1B,cAAe,SAAS,CAAAC,YAAYA,CAAAC,IAAA,CAAiF,IAA/E,CAACC,WAAW,CAAEC,WAAW,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,CAAC,CAAAP,IAAA,CAEjH,KAAM,CAACQ,IAAI,CAACC,OAAO,CAAC,CAACnB,QAAQ,CAAC,EAAE,CAAC,CAEjC,QAAS,CAAAoB,SAASA,CAAA,CAAE,CACjB,MAAO,CAAAF,IAAI,CAACG,MAAM,CAAC,CAAC,CACvB,CAKAtB,SAAS,CAAC,IAAI,CACXuB,QAAQ,CAACC,cAAc,CAAC,mBAAmB,CAAC,CAACC,SAAS,CAAC,QAAQ,CAClE,CAAC,CAAC,CAED,mBAIEpB,KAAA,CAAAI,SAAA,EAAAiB,QAAA,eACGrB,KAAA,QAAKsB,SAAS,CAAC,UAAU,CAAAD,QAAA,eAChBrB,KAAA,OAAAqB,QAAA,EAAI,GAAC,CAACb,WAAW,CAAC,GAAC,EAAI,CAAC,cACxBN,IAAA,CAACJ,MAAM,EAACwB,SAAS,CAAC,kBAAkB,CAACC,OAAO,CAAEC,CAAC,EAAG,CAC/C,KAAM,CAAAC,KAAK,CAACP,QAAQ,CAACQ,MAAM,CAACC,KAAK,CAAC,GAAG,CAAC,CACrCC,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACC,UAAU,CAAC,OAAO,CAAC,CAAC,CACtCH,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CACdI,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC,CACrCR,CAAC,CAACS,cAAc,CAAC,CAAC,CAClBC,KAAK,CAAC,4CAA4C,CAAE,CACjDC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACN,cAAc,CAAE,kBAAkB,CAClC,eAAe,CAAEX,KACvB,CAAC,CACDX,IAAI,CAAEuB,IAAI,CAACC,SAAS,CAAC,CACf3B,QAAQ,CAAEH,WAChB,CAAC,CACD,CAAC,CAAC,CACD+B,IAAI,CAACC,GAAG,EAAG,CACT,GAAIA,GAAG,CAACC,EAAE,CAAE,MAAO,CAAAD,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC,IACzB,MAAM,IAAI,CAAAC,KAAK,CAAC,yBAAyB,CAAC,EAAC,CAAC,CACnDJ,IAAI,CAACC,GAAG,EAAE,CACRI,MAAM,CAACC,KAAK,CAACL,GAAG,CAAC,CACjB5B,UAAU,CAAC,CAAC,CACZC,SAAS,CAAC,IAAI,CAAC,CAGlB,CAAC,CAAC,CACDiC,KAAK,CAACtB,CAAC,EAAEO,OAAO,CAACC,GAAG,CAACR,CAAC,CAAC,CAAC,CAC5B,CAAE,CAAAH,QAAA,CAAC,cAAY,CAAQ,CAAC,EAC5B,CAAC,cAENrB,KAAA,QAAKsB,SAAS,CAAC,eAAe,CAAAD,QAAA,eAC3BnB,IAAA,QAAK6C,EAAE,CAAC,mBAAmB,CAAA1B,QAAA,CAEvBd,WAAW,CAACyC,QAAQ,EAAIzC,WAAW,CAACyC,QAAQ,CAACC,GAAG,CAACzB,CAAC,eAAGtB,IAAA,CAACL,OAAO,EAACqD,SAAS,CAAG1B,CAAE,CAAC2B,OAAO,CAAE1C,SAAU,CAACD,WAAW,CAAEA,WAAY,EAAMgB,CAAG,CAAC,CAAC,CACpI,CAAC,cAGNtB,IAAA,QAAKoB,SAAS,CAAC,SAAS,CAAAD,QAAA,cAErBrB,KAAA,SAAMsB,SAAS,CAAC,UAAU,CAAC8B,QAAQ,CAAE5B,CAAC,EAAG,CACtCA,CAAC,CAACS,cAAc,CAAC,CAAC,CAClBlB,OAAO,CAAC,EAAE,CAAC,CAAiB;AAC5BL,MAAM,CAAC2C,IAAI,CAAC,aAAa,CAAE,CAACC,IAAI,CAAE3C,QAAQ,CAAE4C,QAAQ,CAAE9C,SAAS,CAAE+C,YAAY,CAAEhD,WAAW,CAAEM,IAAI,CAAEA,IAAI,CAAEiC,EAAE,CAAExC,WAAW,CAACkD,GAAG,CAAC,CAAC,CAC7HjC,CAAC,CAACkC,MAAM,CAACC,aAAa,CAACC,KAAK,CAAC,EAAE,CAClC,CAAE,CAAAvC,QAAA,eACCnB,IAAA,aAAU2D,IAAI,CAAC,MAAM,CAACP,IAAI,CAAC,eAAe,CAACQ,SAAS,CAAC,KAAK,CAACC,QAAQ,CAAEvC,CAAC,EACnET,OAAO,CAACS,CAAC,CAACkC,MAAM,CAACE,KAAK,CACxB,CAAW,CAAC,cACb1D,IAAA,CAACJ,MAAM,EAAC+D,IAAI,CAAC,QAAQ,CAACG,QAAQ,CAAE,CAAChD,SAAS,CAAC,CAAE,CAACM,SAAS,CAAC,QAAQ,CAAAD,QAAA,CAAC,OAAK,CAAQ,CAAC,EAC5E,CAAC,CACL,CAAC,EACJ,CAAC,EAGP,CAAC,CAET","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}